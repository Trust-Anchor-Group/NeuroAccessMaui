<?xml version="1.0" encoding="UTF-8" ?>
<base:BasePopup x:Class="NeuroAccessMaui.UI.Popups.Nfc.NfcHistoryDetailsPopup"
				x:DataType="viewmodel:NfcHistoryDetailsPopupViewModel"
				xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
				xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
				xmlns:l="clr-namespace:NeuroAccessMaui.Services.Localization"
				xmlns:controls="clr-namespace:NeuroAccessMaui.UI.Controls"
				xmlns:base="clr-namespace:NeuroAccessMaui.UI.Popups"
				xmlns:viewmodel="clr-namespace:NeuroAccessMaui.UI.Popups.Nfc"
				xmlns:nfc="clr-namespace:NeuroAccessMaui.Services.Nfc.Ui">

	<Grid Style="{DynamicResource PopupGrid}">
		<Border
			WidthRequest="{Binding ViewWidthRequest}"
			MaximumHeightRequest="{Binding MaximumViewHeightRequest}"
			Style="{DynamicResource PopupBorder}">

			<ScrollView VerticalOptions="Center">
				<VerticalStackLayout Spacing="12">
					<Label Style="{DynamicResource PageTitleLabelSmall}"
						   Text="{l:Localize Details}"/>

					<Border Style="{DynamicResource BorderSubSet}">
						<VerticalStackLayout Spacing="12">
							<Grid ColumnDefinitions="*, auto"
									RowDefinitions="auto, auto">
								<Grid.GestureRecognizers>
									<TapGestureRecognizer Command="{Binding CopyValueCommand}"
											CommandParameter="{Binding Item.TagType}"/>
								</Grid.GestureRecognizers>

								<Label Grid.Row="0"
										Grid.Column="0"
										Text="{l:Localize NfcFieldType}"
										Style="{DynamicResource FieldKeyLabel}"/>
								<controls:SvgView Grid.Row="0"
										Grid.Column="1"
										Aspect="AspectFit"
										HeightRequest="16"
										WidthRequest="16"
										Source="content_copy.svg"
										TintColor="{DynamicResource ContentSecondaryWL}"/>
								<Label Grid.Row="1"
										Grid.ColumnSpan="2"
										Text="{Binding Item.TagType}"
										Style="{DynamicResource FieldValueLabel}"
										TextColor="{DynamicResource ContentLinkWL}"
										LineBreakMode="CharacterWrap"/>
							</Grid>

							<Grid ColumnDefinitions="*, auto"
									RowDefinitions="auto, auto">
								<Grid.GestureRecognizers>
									<TapGestureRecognizer Command="{Binding CopyValueCommand}"
											CommandParameter="{Binding Item.TagIdHex}"/>
								</Grid.GestureRecognizers>

								<Label Grid.Row="0"
										Grid.Column="0"
										Text="{l:Localize NfcFieldId}"
										Style="{DynamicResource FieldKeyLabel}"/>
								<controls:SvgView Grid.Row="0"
										Grid.Column="1"
										Aspect="AspectFit"
										HeightRequest="16"
										WidthRequest="16"
										Source="content_copy.svg"
										TintColor="{DynamicResource ContentSecondaryWL}"/>
								<Label Grid.Row="1"
										Grid.ColumnSpan="2"
										Text="{Binding Item.TagIdHex}"
										Style="{DynamicResource FieldValueLabel}"
										TextColor="{DynamicResource ContentLinkWL}"
										LineBreakMode="CharacterWrap"/>
							</Grid>

							<Grid ColumnDefinitions="*, auto"
									RowDefinitions="auto, auto">
								<Grid.GestureRecognizers>
									<TapGestureRecognizer Command="{Binding CopyValueCommand}"
											CommandParameter="{Binding Item.DetectedAtUtc, StringFormat='{0:O}'}"/>
								</Grid.GestureRecognizers>

								<Label Grid.Row="0"
										Grid.Column="0"
										Text="{l:Localize NfcFieldDetectedUtc}"
										Style="{DynamicResource FieldKeyLabel}"/>
								<controls:SvgView Grid.Row="0"
										Grid.Column="1"
										Aspect="AspectFit"
										HeightRequest="16"
										WidthRequest="16"
										Source="content_copy.svg"
										TintColor="{DynamicResource ContentSecondaryWL}"/>
								<Label Grid.Row="1"
										Grid.ColumnSpan="2"
										Text="{Binding Item.DetectedAtUtc, StringFormat='{0:O}'}"
										Style="{DynamicResource FieldValueLabel}"
										TextColor="{DynamicResource ContentLinkWL}"
										LineBreakMode="CharacterWrap"/>
							</Grid>

							<Grid ColumnDefinitions="*, auto"
									RowDefinitions="auto, auto">
								<Grid.GestureRecognizers>
									<TapGestureRecognizer Command="{Binding CopyValueCommand}"
											CommandParameter="{Binding Item.InterfacesSummary}"/>
								</Grid.GestureRecognizers>

								<Label Grid.Row="0"
										Grid.Column="0"
										Text="{l:Localize NfcFieldTechnologies}"
										Style="{DynamicResource FieldKeyLabel}"/>
								<controls:SvgView Grid.Row="0"
										Grid.Column="1"
										Aspect="AspectFit"
										HeightRequest="16"
										WidthRequest="16"
										Source="content_copy.svg"
										TintColor="{DynamicResource ContentSecondaryWL}"/>
								<Label Grid.Row="1"
										Grid.ColumnSpan="2"
										Text="{Binding Item.InterfacesSummary}"
										Style="{DynamicResource FieldValueLabel}"
										TextColor="{DynamicResource ContentLinkWL}"
										LineBreakMode="CharacterWrap"/>
							</Grid>
						</VerticalStackLayout>
					</Border>

					<Border Style="{DynamicResource BorderSubSet}">
						<VerticalStackLayout Spacing="12">
							<Grid ColumnDefinitions="*, auto"
									RowDefinitions="auto, auto">
								<Grid.GestureRecognizers>
									<TapGestureRecognizer Command="{Binding CopyValueCommand}"
											CommandParameter="{Binding Item.NdefSummary}"/>
								</Grid.GestureRecognizers>

								<Label Grid.Row="0"
										Grid.Column="0"
										Text="{l:Localize NfcFieldNdef}"
										Style="{DynamicResource FieldKeyLabel}"/>
								<controls:SvgView Grid.Row="0"
										Grid.Column="1"
										Aspect="AspectFit"
										HeightRequest="16"
										WidthRequest="16"
										Source="content_copy.svg"
										TintColor="{DynamicResource ContentSecondaryWL}"/>
								<Label Grid.Row="1"
										Grid.ColumnSpan="2"
										Text="{Binding Item.NdefSummary}"
										Style="{DynamicResource FieldValueLabel}"
										TextColor="{DynamicResource ContentLinkWL}"
										LineBreakMode="CharacterWrap"/>
							</Grid>

							<Grid ColumnDefinitions="*, auto"
									RowDefinitions="auto, auto"
									IsVisible="{Binding HasUri}">
								<Grid.GestureRecognizers>
									<TapGestureRecognizer Command="{Binding CopyValueCommand}"
											CommandParameter="{Binding Item.ExtractedUri}"/>
								</Grid.GestureRecognizers>

								<Label Grid.Row="0"
										Grid.Column="0"
										Text="URI"
										Style="{DynamicResource FieldKeyLabel}"/>
								<controls:SvgView Grid.Row="0"
										Grid.Column="1"
										Aspect="AspectFit"
										HeightRequest="16"
										WidthRequest="16"
										Source="content_copy.svg"
										TintColor="{DynamicResource ContentSecondaryWL}"/>
								<Label Grid.Row="1"
										Grid.ColumnSpan="2"
										Text="{Binding Item.ExtractedUri}"
										Style="{DynamicResource FieldValueLabel}"
										TextColor="{DynamicResource ContentLinkWL}"
										LineBreakMode="CharacterWrap"/>
							</Grid>
						</VerticalStackLayout>
					</Border>

					<Grid ColumnDefinitions="*,*,*,*"
							ColumnSpacing="8">
						<controls:TextButton Grid.Column="0"
											 Command="{Binding CopyUriCommand}"
											 Style="{DynamicResource OutlinedTextButton}"
											 LabelData="{l:Localize CopyToClipboard}"
											 IsVisible="{Binding HasUri}"/>
						<controls:TextButton Grid.Column="1"
											 Command="{Binding OpenUriCommand}"
											 Style="{DynamicResource FilledTextButton}"
											 LabelData="{l:Localize Open}"
											 IsVisible="{Binding HasUri}"/>
						<controls:TextButton Grid.Column="2"
											 Command="{Binding ExportJsonCommand}"
											 Style="{DynamicResource OutlinedTextButton}"
											 LabelData="{l:Localize Export}"/>
						<controls:TextButton Grid.Column="3"
											 Command="{Binding ExportXmlCommand}"
											 Style="{DynamicResource OutlinedTextButton}"
											 LabelData="{l:Localize NfcExportXml}"/>
					</Grid>

					<Border Style="{DynamicResource BorderSubSet}"
							IsVisible="{Binding HasNdefRecords}">
						<VerticalStackLayout Spacing="8">
							<Label Text="{l:Localize NfcFieldNdefRecords}"
								   Style="{DynamicResource FieldKeyLabel}"/>
							<CollectionView ItemsSource="{Binding Item.NdefRecords}"
											SelectionMode="None">
								<CollectionView.ItemTemplate>
									<DataTemplate x:DataType="nfc:NfcNdefRecordSnapshot">
										<VerticalStackLayout Spacing="2"
												Padding="0,6">
											<Label Text="{Binding RecordType}"
													Style="{DynamicResource FieldTitleLabel}"/>
											<Label Text="{Binding DisplayValue}"
													Style="{DynamicResource FieldValueLabel}"
													LineBreakMode="CharacterWrap"/>
										</VerticalStackLayout>
									</DataTemplate>
								</CollectionView.ItemTemplate>
							</CollectionView>
						</VerticalStackLayout>
					</Border>

					<controls:TextButton
						Command="{Binding CloseCommand}"
						Style="{DynamicResource OutlinedTextButton}"
						LabelData="{l:Localize Cancel}"/>
				</VerticalStackLayout>
			</ScrollView>
		</Border>
	</Grid>
</base:BasePopup>
